"use strict";(globalThis.webpackChunkrelease_tool_website=globalThis.webpackChunkrelease_tool_website||[]).push([[733],{8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var i=s(6540);const t={},l=i.createContext(t);function r(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(l.Provider,{value:n},e.children)}},9998:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"development","title":"Development","description":"\x3c!--","source":"@site/doc/development.md","sourceDirName":".","slug":"/development","permalink":"/release-tool/docs/development","draft":false,"unlisted":false,"editUrl":"https://github.com/sequentech/release-tool/tree/main/docs/doc/development.md","tags":[],"version":"current","frontMatter":{"id":"development","title":"Development"},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/release-tool/docs/configuration"},"next":{"title":"Installation","permalink":"/release-tool/docs/installation"}}');var t=s(4848),l=s(8453);const r={id:"development",title:"Development"},o="Development Guide",c={},a=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Testing",id:"testing",level:2},{value:"Running Tests",id:"running-tests",level:3},{value:"Test Categories",id:"test-categories",level:3},{value:"Unit Tests",id:"unit-tests",level:4},{value:"Docker Tests",id:"docker-tests",level:4},{value:"GitHub Actions",id:"github-actions",level:2},{value:"Test Workflow",id:"test-workflow",level:3},{value:"Documentation Deployment Workflow",id:"documentation-deployment-workflow",level:3},{value:"REUSE Compliance Check",id:"reuse-compliance-check",level:3},{value:"Docker Image &amp; Registry",id:"docker-image--registry",level:2},{value:"Public Registry Access",id:"public-registry-access",level:2},{value:"Enabling Public Access",id:"enabling-public-access",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Local Development",id:"local-development",level:2},{value:"Building the Docker Image Locally",id:"building-the-docker-image-locally",level:3},{value:"VS Code Task",id:"vs-code-task",level:3},{value:"Usage",id:"usage",level:2},{value:"Pulling the image",id:"pulling-the-image",level:3},{value:"Running the tool",id:"running-the-tool",level:3},{value:"Extending the image (e.g., for Release Bot)",id:"extending-the-image-eg-for-release-bot",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"development-guide",children:"Development Guide"})}),"\n",(0,t.jsxs)(n.p,{children:["This guide covers development workflows, testing, Docker image management, and CI/CD for the ",(0,t.jsx)(n.code,{children:"release-tool"})," project."]}),"\n",(0,t.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#testing",children:"Testing"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#github-actions",children:"GitHub Actions"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#docker-image--registry",children:"Docker Image & Registry"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#local-development",children:"Local Development"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.h3,{id:"running-tests",children:"Running Tests"}),"\n",(0,t.jsx)(n.p,{children:"The project uses pytest for testing. All tests can be run using Poetry:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run all tests\npoetry run pytest\n\n# Run with verbose output\npoetry run pytest -v\n\n# Run specific test file\npoetry run pytest tests/test_models.py -v\n\n# Run with coverage report\npoetry run pytest --cov=release_tool --cov-report=html\n"})}),"\n",(0,t.jsx)(n.h3,{id:"test-categories",children:"Test Categories"}),"\n",(0,t.jsx)(n.h4,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,t.jsx)(n.p,{children:"Standard unit tests covering:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Models and data structures (",(0,t.jsx)(n.code,{children:"test_models.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Configuration management (",(0,t.jsx)(n.code,{children:"test_config.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Database operations (",(0,t.jsx)(n.code,{children:"test_db.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Git operations (",(0,t.jsx)(n.code,{children:"test_git_ops.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Policies and business logic (",(0,t.jsx)(n.code,{children:"test_policies.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Template rendering (",(0,t.jsx)(n.code,{children:"test_output_template.py"}),", ",(0,t.jsx)(n.code,{children:"test_default_template.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Issue management (",(0,t.jsx)(n.code,{children:"test_query_issues.py"}),", ",(0,t.jsx)(n.code,{children:"test_partial_issues.py"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Publishing and syncing (",(0,t.jsx)(n.code,{children:"test_publish.py"}),", ",(0,t.jsx)(n.code,{children:"test_sync.py"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run all unit tests except Docker tests\npoetry run pytest tests/ --ignore=tests/test_docker.py\n"})}),"\n",(0,t.jsx)(n.h4,{id:"docker-tests",children:"Docker Tests"}),"\n",(0,t.jsx)(n.p,{children:"Docker integration tests verify:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Docker image builds successfully from the Dockerfile"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"release-tool"})," executable is available in the image"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"release-tool -h"})," returns a successful exit code"]}),"\n",(0,t.jsxs)(n.li,{children:["Docker image runs ",(0,t.jsx)(n.code,{children:"release-tool"})," as its default command"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run Docker tests (requires Docker to be running)\npoetry run pytest tests/test_docker.py -v\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": Docker tests take longer (~20-30 seconds) as they build the actual Docker image."]}),"\n",(0,t.jsx)(n.h2,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,t.jsxs)(n.p,{children:["The project uses GitHub Actions for continuous integration and delivery. All workflows are defined in ",(0,t.jsx)(n.code,{children:".github/workflows/"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"test-workflow",children:"Test Workflow"}),"\n",(0,t.jsxs)(n.p,{children:["File: ",(0,t.jsx)(n.code,{children:".github/workflows/test.yml"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Triggers"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Push to ",(0,t.jsx)(n.code,{children:"main"})," branch"]}),"\n",(0,t.jsxs)(n.li,{children:["Pull requests to ",(0,t.jsx)(n.code,{children:"main"})," branch"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Sets up a test matrix for Python 3.10, 3.11, and 3.12"}),"\n",(0,t.jsx)(n.li,{children:"Installs Poetry and project dependencies"}),"\n",(0,t.jsx)(n.li,{children:"Runs all unit tests (excluding Docker tests)"}),"\n",(0,t.jsx)(n.li,{children:"Runs Docker tests separately"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Running locally with act"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://github.com/nektos/act",children:"act"})," allows you to test GitHub Actions workflows locally:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Install act (macOS)\nbrew install act\n\n# List available workflows\nact -l\n\n# Run the test workflow\nact -j test --container-architecture linux/amd64\n\n# Run with a specific runner image\nact -j test --container-architecture linux/amd64 -P ubuntu-latest=catthehacker/ubuntu:act-latest\n\n# Run and show verbose output\nact -j test --container-architecture linux/amd64 -v\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": On Apple M-series chips, use ",(0,t.jsx)(n.code,{children:"--container-architecture linux/amd64"})," to avoid compatibility issues."]}),"\n",(0,t.jsx)(n.h3,{id:"documentation-deployment-workflow",children:"Documentation Deployment Workflow"}),"\n",(0,t.jsxs)(n.p,{children:["File: ",(0,t.jsx)(n.code,{children:".github/workflows/deploy-docs.yml"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Triggers"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Push to ",(0,t.jsx)(n.code,{children:"main"})," branch (only when files in ",(0,t.jsx)(n.code,{children:"docs/"})," change)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Sets up Node.js environment"}),"\n",(0,t.jsxs)(n.li,{children:["Installs dependencies in ",(0,t.jsx)(n.code,{children:"docs/"})," directory"]}),"\n",(0,t.jsx)(n.li,{children:"Builds the Docusaurus static site"}),"\n",(0,t.jsxs)(n.li,{children:["Deploys the ",(0,t.jsx)(n.code,{children:"docs/build"})," directory to the ",(0,t.jsx)(n.code,{children:"gh-pages"})," branch"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Running locally with act"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run the deploy-docs workflow\nact -j deploy --container-architecture linux/amd64\n"})}),"\n",(0,t.jsx)(n.h3,{id:"reuse-compliance-check",children:"REUSE Compliance Check"}),"\n",(0,t.jsxs)(n.p,{children:["File: ",(0,t.jsx)(n.code,{children:".github/workflows/reuse.yml"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Triggers"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Push to ",(0,t.jsx)(n.code,{children:"main"})," branch"]}),"\n",(0,t.jsxs)(n.li,{children:["Pull requests to ",(0,t.jsx)(n.code,{children:"main"})," branch"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it does"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Checks the repository for REUSE compliance (licenses and copyright headers)."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Running locally"}),":"]}),"\n",(0,t.jsx)(n.p,{children:'You can run the check locally using the VS Code task "Tool: Check REUSE Compliance" or manually:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"poetry run python -m pip install reuse\npoetry run reuse lint\n"})}),"\n",(0,t.jsx)(n.h2,{id:"docker-image--registry",children:"Docker Image & Registry"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"release-tool"})," is available as a Docker image stored in the GitHub Container Registry (GHCR). This allows other tools (like ",(0,t.jsx)(n.code,{children:"release-bot"}),") or CI pipelines to use the tool without installing Python dependencies manually."]}),"\n",(0,t.jsx)(n.h2,{id:"public-registry-access",children:"Public Registry Access"}),"\n",(0,t.jsxs)(n.p,{children:["The Docker image is published to:\n",(0,t.jsx)(n.code,{children:"ghcr.io/sequentech/release-tool"})]}),"\n",(0,t.jsx)(n.h3,{id:"enabling-public-access",children:"Enabling Public Access"}),"\n",(0,t.jsxs)(n.p,{children:["To ensure the image is publicly pullable (so ",(0,t.jsx)(n.code,{children:"release-bot"})," or other users can use it without authentication):"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Ensure the repository is public"}),': Go to the repository settings and verify that the repository visibility is set to "Public".']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Configure organization package settings"}),": In the organization settings (Settings -> Packages), ensure that packages are configured to inherit the repository's visibility. This allows packages from public repositories to be automatically public."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Verify package visibility"}),": Navigate to the repository's ",(0,t.jsx)(n.strong,{children:"Packages"})," section (right sidebar on the main page), click on the ",(0,t.jsx)(n.code,{children:"release-tool"}),' package, and confirm it shows as "Public".']}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The workflow uses the standard ",(0,t.jsx)(n.code,{children:"GITHUB_TOKEN"}),' to authenticate with GHCR. No additional secrets are required for the repository itself, provided "Read and write permissions" are enabled for workflows in the repository settings (Settings -> Actions -> General -> Workflow permissions).']}),"\n",(0,t.jsx)(n.h2,{id:"local-development",children:"Local Development"}),"\n",(0,t.jsx)(n.h3,{id:"building-the-docker-image-locally",children:"Building the Docker Image Locally"}),"\n",(0,t.jsx)(n.p,{children:"You can build the image locally for testing purposes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker build -t release-tool:local .\n"})}),"\n",(0,t.jsx)(n.h3,{id:"vs-code-task",children:"VS Code Task"}),"\n",(0,t.jsxs)(n.p,{children:["For convenience, a VS Code task is included. Open the Command Palette (",(0,t.jsx)(n.code,{children:"Cmd+Shift+P"}),") and run ",(0,t.jsx)(n.strong,{children:"Tasks: Run Build Task"}),' (or select "Docker: Build Image") to build the image directly from the editor.']}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h3,{id:"pulling-the-image",children:"Pulling the image"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/sequentech/release-tool:latest\n"})}),"\n",(0,t.jsx)(n.h3,{id:"running-the-tool",children:"Running the tool"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $(pwd):/workspace -w /workspace ghcr.io/sequentech/release-tool release-tool --help\n"})}),"\n",(0,t.jsx)(n.h3,{id:"extending-the-image-eg-for-release-bot",children:"Extending the image (e.g., for Release Bot)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dockerfile",children:'FROM ghcr.io/sequentech/release-tool:latest\n\n# Add your wrapper scripts\nCOPY main.py /app/\n\nENTRYPOINT ["python", "/app/main.py"]\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);